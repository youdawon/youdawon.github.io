---
layout: post
date: 2024-08-15
title: "[SystemDesign-Twitter Search] System flows"
tags: [SystemDesign, Architecture, Twitter Search, ]
categories: [SystemDesign, Problems, Twitter Search, ]
---


### 1. **사용자 요청**

- 사용자가 트윗을 올리거나 검색하려고 요청을 보낸다.

#### 2. **로드 밸런서 / API 게이트웨이**

- 사용자의 요청이 로드 밸런서나 API 게이트웨이로 간다.
- 게이트웨이가 요청을 트윗 서비스나 검색 서비스로 라우팅한다.

#### 3. **트윗 게시 흐름**

1. **트윗 서비스**:
	- 트윗을 올리려는 요청이 트윗 서비스로 간다.
	- 트윗 서비스가 새로운 트윗을 처리하고, 메시지 브로커에 새 트윗을 발행하라고 요청한다.
2. **메시지 브로커**:
	- 메시지 브로커가 요청을 받아서 트윗이 발행되도록 한다.
3. **캐시 (Redis)**:
	- 트윗 서비스가 새 트윗을 캐시에 저장한다. 캐시는 TTL이나 LFU 같은 메커니즘으로 관리된다.
4. **메타데이터 저장소 (NoSQL)**:
	- 새 트윗의 메타데이터를 NoSQL 데이터베이스에 저장한다.
5. **인덱스 빌더 서버**:
	- 인덱스 빌더 서버가 새 트윗을 인덱싱하고, 이를 인덱스 저장소에 업데이트한다.
6. **인덱스 저장소 (NoSQL)**:
	- 인덱스 저장소에 검색을 위한 인덱스 데이터를 보관한다.

#### 4. **트윗 검색 흐름**

1. **검색 서비스**:
	- 트윗 검색 요청이 검색 서비스로 간다.
2. **메시지 브로커**:
	- 검색 요청이 메시지 브로커로 전달된다.
3. **Elasticsearch**:
	- Elasticsearch가 요청된 검색어에 맞는 트윗을 찾고, 캐시와 연동하여 데이터를 가져온다.
4. **캐시 (Redis)**:
	- 캐시에 검색된 트윗이 있으면 빠르게 반환한다.
5. **검색 결과 반환**:
	- 최종적으로 검색된 트윗이 사용자에게 반환된다.

#### 5. **최종 상태**

- 게시된 트윗은 캐시, 메타데이터 저장소, 인덱스 빌더, 인덱스 저장소에 저장되어 이후 검색할 수 있도록 준비된다.
- 검색 요청은 Elasticsearch와 캐시를 통해 빠르게 처리되고, 사용자에게 검색 결과가 전달된다.

![0](/assets/img/2024-08-15-[SystemDesign-Twitter-Search]-System-flows.md/0.png)

