---
layout: post
date: 2024-08-13
title: "[Architecture] Consistent Hashing"
tags: [Architecture, Load Balancer, ]
categories: [Architecture, ]
---


### 일관된 해싱(Consistent Hashing)


**일관된 해싱**은 분산 시스템에서 데이터를 여러 서버(또는 노드)에 균등하게 분배하고, 서버 추가/제거 시 데이터 재배치를 최소화하는 로드 밸런싱 알고리즘의 하나다. 이 알고리즘은 특히 대규모 분산 시스템에서 효율적인 데이터 관리와 부하 분산을 가능하게 한다.


#### 1. **일관된 해싱의 정의 및 주요 특징**

- **정의**: 데이터를 고유한 해시 값으로 변환한 후, 그 해시 값을 기반으로 특정 서버에 데이터를 할당하는 방법.
- **주요 특징**:
	- **데이터 일관성 유지**: 특정 데이터(예: 비디오 ID)가 항상 동일한 서버에 할당되도록 보장한다.
	- **서버 추가/제거 시 안정성**: 서버가 추가되거나 제거될 때 전체 데이터 중 일부만 재배치되며, 대부분의 데이터는 기존 서버에 그대로 남아 있다.
	- **부하 분산**: 데이터를 고르게 분배하여 서버 간 부하를 효율적으로 분산시킨다.

#### 2. **일반적인 로드 밸런싱 알고리즘과의 비교**

- **Round-Robin**:
	- **정의**: 들어오는 요청을 순차적으로 서버에 분배하는 방식.
	- **특징**: 서버 간에 부하를 고르게 분산시키지만, 데이터와 서버 간의 연관성을 고려하지 않는다.
	- **적합한 사용 사례**: 요청의 무게가 동일하고, 서버 간에 특별한 상태 유지가 필요하지 않은 경우.
- **Least Connections**:
	- **정의**: 가장 적은 연결을 가진 서버로 트래픽을 보내는 방식.
	- **특징**: 서버의 실시간 부하를 고려하지만, 데이터와의 연관성을 고려하지 않는다.
	- **적합한 사용 사례**: 서버 간 부하를 실시간으로 조절하고, 특정 데이터와의 연관성이 중요하지 않은 경우.

#### 3. **일관된 해싱과 로드 밸런싱의 연관성**

- **연관성**:
	- 일관된 해싱은 로드 밸런싱 알고리즘의 하나로, 데이터 일관성 유지와 서버 간 부하 분산을 동시에 해결해야 하는 상황에서 사용된다.
	- Round-Robin이나 Least Connections 같은 전통적인 로드 밸런싱 알고리즘과는 다르게, 데이터와 서버 간의 관계를 중시하며, 서버 추가/제거 시 데이터 재배치를 최소화하는 데 강점을 가지고 있다.

#### 4. **서버 추가 시 데이터 재배치**

- **일관된 해싱의 장점**:
	- 서버 추가 시 전체 데이터의 재배치가 아닌 일부 데이터만 이동되므로, 데이터 재배치가 최소화된다.
	- 완전히 재배치가 필요 없는 것은 아니지만, 전통적인 해싱 방법에 비해 훨씬 적은 양의 데이터만 재배치된다.

#### 5. **일관된 해싱의 구체적 사례**

- **분산 캐시 시스템 (예: Memcached)**:
	- **문제**: 서버 추가/제거 시 캐시된 데이터의 대규모 재배치.
	- **해결**: 일관된 해싱을 통해 일부 데이터만 이동, 캐시 효율성 유지.
- **분산 데이터베이스 (예: Apache Cassandra)**:
	- **문제**: 노드 추가/제거 시 데이터 일관성 문제.
	- **해결**: 일관된 해싱으로 데이터 재배치 최소화, 시스템 안정성 유지.
- **콘텐츠 전송 네트워크 (CDN)**:
	- **문제**: 새로운 서버 추가 시 캐시된 콘텐츠의 재배치.
	- **해결**: 일관된 해싱으로 일부 콘텐츠만 이동, 빠르고 안정적인 콘텐츠 제공.
- **분산 파일 시스템 (예: Amazon DynamoDB)**:
	- **문제**: 파티션 추가/제거 시 데이터 이동.
	- **해결**: 일관된 해싱으로 최소한의 데이터만 이동, 성능과 안정성 유지.

#### 6. **결론**

- **일관된 해싱**은 데이터 일관성을 유지하면서 서버 간 부하를 효율적으로 분산시킬 수 있는 로드 밸런싱 알고리즘이다. 특히 서버 추가나 제거 시 데이터 재배치를 최소화하는 데 강점을 가지고 있으며, 다양한 분산 시스템에서 사용된다. 이를 통해 시스템의 확장성과 안정성을 유지할 수 있다.
