---
layout: post
date: 2024-08-13
title: "[SystemDesign-Typeahead Suggestion] 검색어 시스템 복구 방법"
tags: [SystemDesign, Architecture, Typeahead Suggestion, ]
categories: [SystemDesign, Problems, Typeahead Suggestion, ]
---


### 1. **Trie 스냅샷을 활용한 복구**


Trie 스냅샷을 생성해 두면, 서버가 재시작되었을 때 빠르게 Trie 구조를 복구할 수 있다.


#### **복구 과정**

1. **Trie 스냅샷 생성**:
	- Trie의 구조를 주기적으로 파일에 저장하여, 각 노드의 문자, 자식 노드 정보, 빈도수 등을 포함하도록 한다.
	- 이 스냅샷은 서버가 정상 동작 중일 때 주기적으로 생성하여, 데이터가 최신 상태로 유지되도록 한다.
2. **서버 재시작 시 Trie 복구**:
	- 서버 재시작 시, 저장된 Trie 스냅샷 파일을 읽어와 Trie를 복구한다.
	- 파일에 저장된 데이터를 바탕으로 각 노드를 생성하고, 부모-자식 관계를 복원하여 원래의 Trie 구조로 재구성한다.
3. **추천어 재계산**:
	- Trie가 복구된 후, 각 노드에서 상위 추천어를 다시 계산하여 검색어 추천 기능을 복원한다.

#### 2. **Min-Heap을 활용한 실시간 복구**


Min-Heap은 실시간으로 상위 N개의 검색어를 유지하는 데 사용되며, 서버 재시작 시에도 빠르게 복구할 수 있다.


#### **복구 과정**

1. **Trie 스냅샷을 이용한 Trie 복구**:
	- 서버 재시작 후, Trie 스냅샷을 읽어와 Trie 구조를 복구한다.
2. **Min-Heap 재생성**:
	- 복구된 Trie 구조에서 각 노드의 데이터를 사용해 Min-Heap을 다시 구성한다.
	- 각 노드에서 빈도수가 높은 검색어들을 Min-Heap에 삽입하여 상위 N개의 검색어를 유지한다.
3. **실시간 검색어 추천**:
	- 복구된 Min-Heap을 사용해 실시간으로 상위 검색어를 추천하는 기능을 재개한다.
