---
layout: post
date: 2024-08-16
title: "[SystemDesign] API Gateway"
tags: [SystemDesign, API Gateway, ]
categories: [SystemDesign, Basics, ]
---


**API Gateway**는 마이크로서비스 아키텍처에서 클라이언트 요청을 중앙에서 관리하는 중요한 구성 요소로, 클라이언트와 다양한 마이크로서비스 간의 상호작용을 통합하여 관리하는 역할을 한다.


#### 주요 기능:

- **단일 진입점**: 클라이언트가 여러 마이크로서비스에 직접 접근하지 않고, 하나의 API Gateway를 통해 요청을 처리할 수 있도록 한다.
- **요청 라우팅**: 클라이언트의 요청을 적절한 백엔드 마이크로서비스로 전달한다.
- **인증 및 권한 관리**: 요청이 올바르게 인증되었는지, 권한이 있는지 확인하여 보안을 강화한다.
- **요청 변환**: 클라이언트와 마이크로서비스 간의 요청과 응답을 적절한 형식으로 변환하여 상호 호환성을 유지한다.
- **모니터링 및 로깅**: 요청과 응답을 추적하고 기록하여 시스템의 상태를 모니터링하고, 문제를 해결할 수 있게 한다.

#### 장점:

- **중앙 관리**: 보안, 인증, 트래픽 제어 등을 중앙에서 관리할 수 있어, 시스템의 복잡성을 줄이고 일관성을 유지한다.
- **확장성**: 여러 개의 API Gateway를 사용하거나 로드 밸런싱을 통해 시스템의 확장성을 높일 수 있다.

#### 단점 및 이슈:

- **단일 장애점**: 모든 요청이 API Gateway를 거치므로, 이 부분에서 장애가 발생하면 전체 시스템에 영향을 줄 수 있다.
- **지연 시간 증가**: API Gateway를 거치면서 추가적인 네트워크 지연 시간이 발생할 수 있다.

#### 대응 방안:

- **다중 API Gateway 사용**: 로드 밸런싱을 사용하여 여러 개의 API Gateway 인스턴스를 배포함으로써 성능을 향상시키고, 장애 발생 시에도 시스템 가용성을 유지할 수 있다.
- **요청 제한 및 캐싱**: 요청 제한(Rate Limiting)과 캐싱을 통해 시스템 부하를 줄이고, 응답 시간을 단축할 수 있다.
- **서킷 브레이커 사용**: 서킷 브레이커 패턴을 도입하여 특정 마이크로서비스가 불안정할 때 빠르게 실패하고, 요청을 재시도함으로써 서비스 안정성을 유지할 수 있다.

#### 캐싱 전략


API Gateway에서의 캐싱은 반복적인 요청에 대해 백엔드 서비스의 부하를 줄이고, 응답 속도를 향상시키는 데 중요한 역할을 한다.


#### 주요 캐싱 전략:

1. **응답 캐싱**: 클라이언트가 요청한 데이터에 대해 백엔드 서비스에서 받은 응답을 캐시에 저장하여, 동일한 요청이 들어왔을 때 백엔드로 요청을 보내지 않고 캐시된 응답을 반환한다.
2. **TTL(Time-to-Live) 설정**: 캐시된 데이터의 유효 기간을 설정하여, 일정 시간이 지나면 캐시를 무효화하고 최신 데이터를 다시 가져와 캐시에 저장한다.
3. **경로별 캐싱**: 특정 API 경로에 대해 캐싱을 적용하여, 경로별로 캐싱 전략을 다르게 설정할 수 있다.
4. **캐시 무효화**: 캐시된 데이터가 최신이 아닐 때는 캐시를 무효화하고, 백엔드에서 최신 데이터를 가져와 캐시를 갱신한다.
5. **정적 콘텐츠 캐싱**: 변경되지 않는 정적 콘텐츠(이미지, CSS, JavaScript 등)를 캐시에 저장하여 빠르게 제공한다.

#### 장점:

- **성능 향상**: 캐시를 통해 클라이언트에게 더 빠른 응답을 제공할 수 있다.
- **백엔드 부하 감소**: 반복적인 요청에 대해 백엔드 서비스에 부담을 주지 않도록 한다.
- **비용 절감**: 클라우드 환경에서는 리소스 사용량이 줄어 비용을 절감할 수 있다.

#### 단점:

- **데이터 신선도**: 캐시된 데이터가 오래될 경우, 실시간 데이터를 제공하지 못할 수 있다.
- **복잡성 증가**: 캐시 무효화, TTL 설정 등 캐시 관리의 복잡성이 증가할 수 있다.

이처럼 API Gateway는 다양한 기능과 캐싱 전략을 통해 시스템의 성능과 효율성을 높일 수 있으며, 관리와 확장성을 향상시킬 수 있다.

